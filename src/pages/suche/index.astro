---
import DefaultLayout from '~/layouts/DefaultLayout.astro';
import Breadcrumb from "~/components/page/Breadcrumb.astro";
import MetaHead from "~/components/page/MetaHead.astro";
import SectionTextPict from "~/components/page/SectionTextPict.astro";
import SucheClient from '~/components/SucheClient.jsx';

import { pageinfo } from '~/constants.ts';
const page_title = "Suche in HistVV";

const breadcrumb = [
  { label: "Home", href: "/" },
  { label: "Suche", href: "/suche/" }
];
---

<DefaultLayout>
    <Breadcrumb items={breadcrumb} />

    <MetaHead slot="head"
        title={`${page_title} | ${pageinfo.title} ${pageinfo.byline}`}
        description={`${pageinfo.description}`}
    />

    <Fragment slot="head">
      <link rel="preload" as="fetch" href="/data/tbl_veranstaltungen-merged.json" crossorigin>
      <link rel="preload" as="fetch" href="/data/tbl_dozenten.json" crossorigin>

      <style>
        .spinner-wrap { display:flex; align-items:center; gap:.5rem; padding:.5rem 0; }
        .spinner {
          width: 1.25rem; height: 1.25rem;
          border: .2rem solid #ddd; border-top-color: #555;
          border-radius: 50%; animation: spin 1s linear infinite;
        }
        .spinner-text { color:#666; font-size:.95rem; }
        @keyframes spin { to { transform: rotate(360deg); } }
      </style>

      <script is:inline>
        const removeSpinner = () => document.getElementById('sucheclient-spinner')?.remove();
        document.addEventListener('sucheclient:ready', removeSpinner, { once: true });
      </script>
    </Fragment>

    <SectionTextPict>
        <h1>{page_title}</h1>

        <!-- SSR-Spinner -->
        <div id="sucheclient-spinner" class="spinner-wrap" aria-live="polite" aria-busy="true">
          <div class="spinner" role="status" aria-label="Suche wird geladen"></div>
          <span class="spinner-text">Lade Sucheâ€¦</span>
        </div>
      
        <SucheClient client:only="react" />
    </SectionTextPict>

</DefaultLayout>
