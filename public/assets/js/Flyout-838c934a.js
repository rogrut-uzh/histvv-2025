import{B as t,W as e}from"./ui.mjs";import{i as s}from"./IsClickOutside-21bf1e40.js";import{f as i}from"./fastdom-104862b0.js";import{c as o}from"./popper-f938939c.js";class l extends t{init(t){return this.el=t,this.flyoutEl=document.querySelector("#".concat(this.el.getAttribute("aria-controls"))),this.on("click",this.onClick),this.on(document.body,"click",this.handleOutsideClick),this.on(this.flyoutEl,"click",".js-Flyout--close",this.onCloseButtonClick),this}onClick(t){t.preventDefault(),this.toggle()}onCloseButtonClick(t){t.preventDefault(),this.close(),setTimeout((()=>{this.el.focus()}),0)}toggle(){this.isOpen()?this.close():this.open()}open(){this.popperInstance=o(this.el,this.flyoutEl,{placement:"bottom-start"}),i.mutate((()=>{this.el.setAttribute("aria-expanded","true"),this.focusTrapRelease=e.keepFocus(this.flyoutEl),e.focusFirst(this.flyoutEl,"a")}))}close(){i.mutate((()=>{this.el.setAttribute("aria-expanded","false"),this.focusTrapRelease&&this.focusTrapRelease(),this.popperInstance.destroy()}))}isOpen(){return"true"===this.el.getAttribute("aria-expanded")}handleOutsideClick(t){this.isOpen()&&s([this.flyoutEl,this.el],t.target)&&this.close()}}function a(){return new l}export{l as Flyout,a as default};
