import{_ as e}from"./_rollupPluginBabelHelpers-56fbbc65.js";import{B as a,c as t}from"./ui.mjs";import{$ as r,N as s,S as i}from"./navigation-d2e99bbf.js";import{P as l,A as o}from"./autoplay-a58ed208.js";import{f as p}from"./fastdom-104862b0.js";function n({swiper:e,extendParams:a,on:t}){a({parallax:{enabled:!1}});const s=(a,t)=>{const{rtl:s}=e,i=r(a),l=s?-1:1,o=i.attr("data-swiper-parallax")||"0";let p=i.attr("data-swiper-parallax-x"),n=i.attr("data-swiper-parallax-y");const d=i.attr("data-swiper-parallax-scale"),u=i.attr("data-swiper-parallax-opacity");if(p||n?(p=p||"0",n=n||"0"):e.isHorizontal()?(p=o,n="0"):(n=o,p="0"),p=p.indexOf("%")>=0?parseInt(p,10)*t*l+"%":p*t*l+"px",n=n.indexOf("%")>=0?parseInt(n,10)*t+"%":n*t+"px",null!=u){const e=u-(u-1)*(1-Math.abs(t));i[0].style.opacity=e}if(null==d)i.transform(`translate3d(${p}, ${n}, 0px)`);else{const e=d-(d-1)*(1-Math.abs(t));i.transform(`translate3d(${p}, ${n}, 0px) scale(${e})`)}},i=()=>{const{$el:a,slides:t,progress:i,snapGrid:l}=e;a.children("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]").each((e=>{s(e,i)})),t.each(((a,t)=>{let o=a.progress;e.params.slidesPerGroup>1&&"auto"!==e.params.slidesPerView&&(o+=Math.ceil(t/2)-i*(l.length-1)),o=Math.min(Math.max(o,-1),1),r(a).find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]").each((e=>{s(e,o)}))}))};t("beforeInit",(()=>{e.params.parallax.enabled&&(e.params.watchSlidesProgress=!0,e.originalParams.watchSlidesProgress=!0)})),t("init",(()=>{e.params.parallax.enabled&&i()})),t("setTranslate",(()=>{e.params.parallax.enabled&&i()})),t("setTransition",((a,t)=>{e.params.parallax.enabled&&((a=e.params.speed)=>{const{$el:t}=e;t.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]").each((e=>{const t=r(e);let s=parseInt(t.attr("data-swiper-parallax-duration"),10)||a;0===a&&(s=0),t.transition(s)}))})(t)}))}class d extends a{constructor(){super()}init(a,r){var p;this.el=a,this.$el=t(this.el);var d=this.$el.data("js-slider");(null===(p=r)||void 0===p?void 0:p.progressbar)&&(r=e(e({},r),{},{on:e(e({},r.on),{},{slideChange:()=>{r.autoplay&&this.updateSwiperProgressBar(r.autoplay.delay)}})})),this.el.dataset.ns=this.ns;var u=this.el.querySelectorAll(".js-Slider--slide:not(.swiper-slide-duplicate)").length>1,c=e(e({modules:[s,l,o,n],wrapperClass:"js-Slider--wrapper",slideClass:"js-Slider--slide",navigation:{prevEl:this.el.querySelector(".js-Slider--prev"),nextEl:this.el.querySelector(".js-Slider--next")},pagination:{el:'[data-ns="'.concat(this.ns,'"] .js-Slider--pagination')},grabCursor:!0,slidesPerView:"auto",centerInsufficientSlides:!0,slidesPerGroupAuto:!0},d||{}),r||{});return u||(c.loop=!1),this.swiper=new i(this.el.querySelector(".js-Slider--slider"),c),this.on(window,"resize",this.onWindowResize),this.swiper.on("update",this.onSwiperUpdate),this.updateGroups(),this}onWindowResize(){clearTimeout(this.windowResizeTimeout),this.windowResizeTimeout=setTimeout((()=>{this.onDebouncedWindowResize()}),300)}onDebouncedWindowResize(){this.updateGroups()}onSwiperUpdate(){p.mutate((()=>{this.el.querySelectorAll(".swiper-slide-duplicate").forEach((e=>{e.setAttribute("aria-hidden","true")}))}))}updateGroups(){if(!0!=!this.swiper.params.slidesPerGroupAuto){var e,a,t=this.el.querySelector(".js-Slider--wrapper"),r=this.el.querySelector(".js-Slider--slide");p.measure((()=>{e=t.getBoundingClientRect(),a=r.getBoundingClientRect()})),p.mutate((()=>{this.swiper.params.slidesPerGroup=Math.round(e.width/a.width),this.swiper.params.loopedSlides=this.swiper.params.slidesPerGroup,this.swiper.update()}))}}updateSwiperProgressBar(e){var a=this.el.querySelector(".js-Slider--next"),t=a.querySelector(".Slider--button--progressbar"),r=a.offsetWidth+2;t||((t=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("class","Slider--button--progressbar"),t.setAttribute("width",r),t.setAttribute("height",r),t.setAttribute("aria-hidden","true"),t.innerHTML='<circle stroke-width="'.concat(1,'" fill="transparent" r="').concat(r/2-2,'" cx="').concat(r/2,'" cy="').concat(r/2,'" />'),a.appendChild(t));var s=t.querySelector("circle"),i=2*(r/2-2)*Math.PI;s.style.strokeDasharray="".concat(i," ").concat(i),s.style.strokeDashoffset=i;var l=e=>{var a=i-e*i;s.style.strokeDashoffset=a,this.el.style.setProperty("--slider-progress",e)},o=performance.now()+(this.swiper?this.swiper.params.speed:0),p=()=>{if(this.swiper.autoplay.paused)return l(0),void requestAnimationFrame(p);var a=performance.now()-o,t=a/e;if(!this.swiper.autoplay.running)return s.style.transition=!1,void l(0);if(a<e){var r=Math.min(Math.max(t,0),1);l(Math.round(100*r)/100),requestAnimationFrame(p),s.style.transition=!1}else l(1),s.style.transition="stroke-dashoffset 0s ease-in-out"};requestAnimationFrame(p)}}function u(){return new d}export{u as default};
