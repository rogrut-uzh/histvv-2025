import{B as t,c as e,W as i}from"./ui.mjs";import{i as s}from"./IsClickOutside-21bf1e40.js";import{p as h,a as o}from"./PreventBodyScroll-9d734936.js";class a extends t{constructor(){super()}init(t){return this.el=t,this.$el=e(t),this.template=document.querySelector("#template-lightbox"),this.templateVideo=document.querySelector("#template-lightbox-video"),this.isOpen=!1,this.isVideo=!!this.$el.attr("data-lightbox-video"),this.attachOpenListeners(),this.$el.parents(".media.photo").length&&this.prepareLegacyElement(),this}prepareLegacyElement(){var t='<span class="visuallyhidden">'.concat(this.$el.text(),"</span>");this.$el.html(t),this.$el.append('\n\t\t\t<span class="TextImage--imageLink--icon">\n\t\t\t\t<span class="Icon" data-name="24--navigation-lupe">\n\t\t\t\t\t<svg>\n\t\t\t\t\t\t<use xlink:href="#24--navigation-lupe"></use>\n\t\t\t\t\t</svg>\n\t\t\t\t</span>\n\t\t\t</span>\n\t\t');var e=this.$el.parents(".media.photo").find("dt img").first()[0];e&&(this.el.style.height="".concat(e.clientHeight,"px"))}open(t){t.preventDefault(),this.isOpen||(this.isOpen=!0,this.createLightbox(),this.attachCloseListeners(),h(),document.documentElement.classList.add("lightbox-open"),this.releaseFocus=i.keepFocus(this.$lightbox),i.focusFirst(this.$lightbox,"button"))}close(){this.isOpen=!1,o(),document.documentElement.classList.remove("lightbox-open"),this.releaseFocus(),this.el.focus(),this.deleteLightbox(),this.attachOpenListeners()}createLightbox(){var t=this.isVideo?this.templateVideo.content.firstElementChild.cloneNode(!0):this.template.content.firstElementChild.cloneNode(!0),i=this.isVideo?"video":"img",s=e(t.querySelectorAll(i));s.attr("src",this.$el.attr("href")||this.$el.attr("data-lightbox-href")),s.attr("width",this.$el.attr("data-lightbox-width")),s.attr("height",this.$el.attr("data-lightbox-height")),document.body.appendChild(t),this.$lightbox=e(t),this.isVideo&&s[0].play()}attachOpenListeners(){this.off(),this.on(this.el,"click",this.open)}attachCloseListeners(){this.off(),this.one(this.$lightbox,"click",".js-Lightbox--close",this.close),this.on(this.$lightbox[0],"click",(t=>{s(this.$lightbox.find(".Lightbox--inner")[0],t.target)&&this.close()}))}deleteLightbox(){this.$lightbox.remove()}}function l(){return new a}export{l as default};
