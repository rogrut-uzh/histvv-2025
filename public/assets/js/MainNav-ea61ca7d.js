import{C as t,S as e,G as i,y as a,f as n,_ as s,c as r,B as o,W as l,V as v,a0 as h}from"./ui.mjs";import"./web.dom-collections.iterator-c5b25a0f.js";import"./es.string.ends-with-e883ac46.js";import{i as u}from"./IsClickOutside-21bf1e40.js";import{C as c}from"./Config-49f58306.js";import"./_rollupPluginBabelHelpers-56fbbc65.js";var m=e,d=i,f=t("".replace),p="[\t\n\v\f\r                　\u2028\u2029\ufeff]",M=RegExp("^"+p+p+"*"),N=RegExp(p+p+"*$"),b=function(t){return function(e){var i=d(m(e));return 1&t&&(i=f(i,M,"")),2&t&&(i=f(i,N,"")),i}},g={start:b(1),end:b(2),trim:b(3)},j=a,y=n,k=t,w=i,x=g.trim,$=j.parseInt,I=j.Symbol,T=I&&I.iterator,C=/^[+-]?0x/i,F=k(C.exec),D=8!==$("\t\n\v\f\r                　\u2028\u2029\ufeff08")||22!==$("\t\n\v\f\r                　\u2028\u2029\ufeff0x16")||T&&!y((function(){$(Object(T))}))?function(t,e){var i=x(w(t));return $(i,e>>>0||(F(C,i)?16:10))}:$;s({global:!0,forced:parseInt!=D},{parseInt:D});class O{static convert(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/[\r\t\n]/g," ").split("[%").join("\t").replace(/((^|%])[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%]/g,"',$1,'").split("\t").join("');").split("%]").join("p.push('").split("\r").join("\\'");return new Function("obj","".concat("var p=[],print=function(){p.push.apply(p,arguments);};with(obj || {}){p.push('").concat(t,"');}return p.join('');"))}}var S=c.get("templates")||{};function H(t){var e=S[t];if(!e){var i=document.getElementById(t);if(!i)return;e=i.innerHTML}return"string"==typeof e&&(e=S[t]=O.convert(e)),e}function A(t,e){var i=H(t);if(i)return i(e)}var B=r("html");class P extends o{constructor(){super()}init(t){return this.el=t,this.$el=r(this.el),this.idCounter=0,this.mql=window.matchMedia("(max-width: 900px)"),this.transitionDuration=this.getTransitionDuration(),this.renderNavigation(),this.bindEvents(),this.initPriorityMenu(),this.calcFlyoutOffset(),this.focusTraps=[],this}isActive(t,e){return!(!t||!e)&&t.replace(".html","")===e.replace(".html","")}renderNavigation(){if("static"!==this.$el.data("mode")){var t=this.$el.find(".js-MainNav--list"),e=window.uzh_nav||[],i=t.find(".js-MainNav--item.is-active"),a=i?[...t.children()].indexOf(i[0]):-1,n=e.map((t=>{var e="main-nav-".concat(this.idCounter++);return t.subitems&&t.subitems.length?"".concat(A("main-nav-button",{href:t.href,ariaCurrent:!1,content:t.text,ariaControls:e})).concat(A("main-nav-overlay",{href:t.href,ariaCurrent:!1,text:t.text,id:e,content:this.renderSubitems(t)})):A("main-nav-link",{href:t.href,ariaCurrent:!(!t.active&&!this.isActive(t.href,window.location.pathname))&&"page",content:t.text})})).filter(Boolean).map((t=>'<li class="MainNav--list--item js-MainNav--item">'.concat(t,"</li>"))).join("").replace(/aria-current="false"/g,"");t.html(n),a>-1&&t.find(".js-MainNav--item").eq(a).addClass("is-active");var s=t.find('[aria-current="page"');s.parents(".js-MainNav--subitem").addClass("is-active"),s.parents(".MainNav--sub--title").addClass("is-active")}}renderSubitems(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.subitems?0===t.subitems.length?"":t.subitems.map((t=>t.subitems&&t.subitems.length?A("main-nav-subitem",{href:t.href,text:t.text,content:this.renderSubitems(t,e+1),ariaCurrent:!(!t.active&&!this.isActive(t.href,window.location.pathname))&&"page",index:e+1,id:"subitem-".concat(this.idCounter++)}):A("main-nav-link-plain",{content:t.text,href:t.href,ariaCurrent:!(!t.active&&!this.isActive(t.href,window.location.pathname))&&"page",index:e+1}))).map((t=>'<li class="MainNav--list--item js-MainNav--subitem">'.concat(t,"</li>"))).join("").replace(/aria-current="false"/g,""):""}bindEvents(){this.on("mouseover",".js-MainNav--link",(t=>{this.handleTopLevelLinkOnDesktop(t,!1)})),this.on("keydown",".js-MainNav--link",(t=>{("Enter"===t.key||13===t.keyCode)&&this.handleTopLevelLinkOnDesktop(t,!0)}));var t=this.el.querySelector(".MainNav--inner");this.on(t,"mouseleave",(()=>{this.isMobile()||this.closeNavItems()})),this.on("click",".js-MainNav--link",(t=>{var e=r(t.target).closest(".js-MainNav--link"),i=r(t.target).attr("aria-controls"),a=!!e.parents(".js-MainNav--overlay").length,n=i&&!!document.querySelector("#".concat(i));this.isMobile()?(this.openMobileNavItem(e),n&&t.preventDefault()):a&&n&&(this.openSubNavItem(e),t.preventDefault())})),this.on("click",".js-MainNav--sublink",(t=>{t.preventDefault();var e=r(t.target);this.isMobile()?this.openMobileNavItem(e):this.openSubNavItem(e)})),this.on("click",".js-MainNav--back",(t=>{var e=r(t.target);this.isMobile()?this.closeMobileNavItem(e):this.closeSubNavItem(e)})),this.on(document,"keyup",(t=>{27===t.keyCode&&(this.closeNavItems(),this.$el.find(".js-MainNav--link").trigger("blur"))})),this.on(document.body,"click",(t=>{u(this.el,t.target)&&B.hasClass("navitem-open")&&this.closeNavItems()})),this.on(this.el,"mouseover",".js-MainNav--sub",(t=>{if(!this.isMobile()){var e=t.delegateTarget,i=null==e?void 0:e.clientHeight;if(i){this.el.style.setProperty("--main-nav_active-subnav-height","".concat(i+16+15,"px"))}}})),this.on("click",".js-MainNav--close",(t=>{this.closeNavItems();var e=r(t.target).parents(".js-MainNav--item").last();e&&l.focusFirst(e,".js-MainNav--link")})),this.on(window,"resize",(()=>{this.checkNav(),this.calcFlyoutOffset(),this.calcFlyoutHeight(),this.calcMobileFlyoutHeight()})),this.mql.addEventListener("change",(()=>{this.closeNavItems()})),this.on(window,"pageshow",(t=>{t.persisted&&this.closeNavItems()}))}isMobile(){return this.mql.matches}handleTopLevelLinkOnDesktop(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.isMobile()){var i=r(t.target),a=i.attr("aria-controls"),n=i.closest(".js-MainNav--link"),s=!!n.parents(".js-MainNav--more").length,o=a&&!!document.querySelector("#".concat(a)),l=!!n.parents(".js-MainNav--overlay").length;o&&t.preventDefault(),s||o?l||"true"===n.attr("aria-hidden")||this.openNavItem(n,e):this.closeNavItems()}}openNavItem(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];v.trigger("MainNav.open"),this.closeNavItems(),t.attr("aria-expanded","true"),B.addClass("navitem-open"),this.calcFlyoutHeight(),this.focusTraps.push(l.keepFocus(t.siblings(".js-MainNav--overlay")));var i=e?".js-MainNav--close":"a, button";l.focusFirst(t.siblings(".js-MainNav--overlay"),i)}closeNavItems(){this.$el.find(".js-MainNav--link, .js-MainNav--sublink").attr("aria-expanded","false"),B.removeClass("navitem-open"),this.$el.find(".js-MainNav--overlay").removeAttr("style").removeAttr("data-mainnav-current-index"),this.$el.removeAttr("style").removeAttr("data-mainnav-current-index-mobile"),this.focusTraps.forEach((t=>t())),this.focusTraps=[]}openSubNavItem(t){v.trigger("MainNav.open"),t.attr("aria-expanded","true");var e=parseInt(t.parents(".js-MainNav--sub").attr("data-mainnav-index"));t.parents(".js-MainNav--item.more").length&&e++,t.parents(".js-MainNav--overlay").attr("data-mainnav-current-index",e).css("--main-nav_index",e),this.calcFlyoutHeight(),this.$el.find(".js-MainNav--overlay").each(((t,e)=>{e.scrollTo({top:0})}));var i=t.parent().find(".js-MainNav--sub");this.focusTraps.push(l.keepFocus(i)),window.setTimeout((()=>{l.focusFirst(i,"a, button")}),this.transitionDuration+1)}closeSubNavItem(t){var e=t.parents(".js-MainNav--subitem, .js-MainNav--item").first().find(".js-MainNav--sublink, .js-MainNav--link");window.setTimeout((()=>{e.attr("aria-expanded","false")}),this.transitionDuration);var i=parseInt(t.parents(".js-MainNav--sub").attr("data-mainnav-index"));i=t.parents(".js-MainNav--item.more").length?i-1:i-2,t.parents(".js-MainNav--overlay").attr("data-mainnav-current-index",i).css("--main-nav_index",i),this.calcFlyoutHeight(),this.$el.find(".js-MainNav--overlay").each(((t,e)=>{e.scrollTo({top:0})})),this.focusTraps.pop()(),window.setTimeout((()=>{var t=this.$el.find('[aria-expanded="true"]').last();l.focusFirst(t.siblings(".js-MainNav--sub, .js-MainNav--overlay"),"a, button")}),this.transitionDuration+1)}openMobileNavItem(t){v.trigger("MainNav.open"),t.attr("aria-expanded","true");var e=parseInt(t.parents(".js-MainNav--sub").attr("data-mainnav-index"));e=e?e+1:1,this.$el.attr("data-mainnav-current-index-mobile",e).css("--main-nav_index-mobile",e),this.calcMobileFlyoutHeight(),v.trigger("MainNav.mobileNavItemToggle"),this.focusTraps.push(l.keepFocus(t.siblings(".js-MainNav--sub, .js-MainNav--overlay").first())),window.setTimeout((()=>{l.focusFirst(t.siblings(".js-MainNav--sub, .js-MainNav--overlay").first(),"a, button")}),this.transitionDuration+1)}closeMobileNavItem(t){var e=t.parents(".js-MainNav--subitem, .js-MainNav--item").first().children(".js-MainNav--sublink, .js-MainNav--link");window.setTimeout((()=>{e.attr("aria-expanded","false")}),this.transitionDuration);var i=parseInt(t.parents(".js-MainNav--sub").attr("data-mainnav-index"));i=i?i-1:0,this.$el.attr("data-mainnav-current-index-mobile",i).css("--main-nav_index-mobile",i),this.calcMobileFlyoutHeight(),v.trigger("MainNav.mobileNavItemToggle"),this.focusTraps.pop()(),window.setTimeout((()=>{var t=this.$el.find('[aria-expanded="true"]').last();t.length?l.focusFirst(t.siblings(".js-MainNav--sub, .js-MainNav--overlay"),"a, button"):l.focusFirst(this.$el,".js-MainNav--link")}),this.transitionDuration+1)}initPriorityMenu(){this.$priorityContainer=this.$el,this.$priorityMenu=this.$el.find(".js-MainNav--list"),this.$overflowMenu=this.$el.find(".js-MainNav--overflow"),this.$menuItems=this.$priorityMenu.find(".js-MainNav--item"),this.$overflowTrigger=this.$el.find(".js-MainNav--more"),this.breakout=[],this.checkNav()}getPriorityWidth(){return this.isMobile()?1e5:this.$priorityContainer[0].offsetWidth+1+(null===(t=this.$priorityContainer[0])||void 0===t?void 0:t.offsetLeft)-this.$overflowTrigger[0].offsetWidth;var t}getItemBreakPoint(t){return t.offsetLeft+t.offsetWidth}itemBreaks(t,e){return t>e}itemBreaksOut(t,e){if(this.breakout[t]<e)return!0}addToOverflow(t,e){this.$overflowMenu[0].insertBefore(t,this.$overflowMenu[0].firstChild),this.breakout.unshift(e)}removeFromOverflow(t){for(var e of t)this.breakout.shift(),this.$priorityMenu[0].appendChild(e)}checkOverflow(t){this.$el.toggleClass("has-overflow",t)}checkNav(){for(var t=this.getPriorityWidth(),e=this.$menuItems.length;e--;){var i=this.$menuItems[e],a=this.getItemBreakPoint(i);this.itemBreaks(a,t)&&this.addToOverflow(i,a)}for(var n=this.$overflowMenu[0].children.length,s=[];n--;)this.itemBreaksOut(n,t)&&s.unshift(this.$overflowMenu[0].children[n]);this.removeFromOverflow(s),this.checkOverflow(this.breakout.length>0)}calcFlyoutOffset(){this.$el.find(".js-MainNav--item").each(((t,e)=>{var i=window.innerWidth-(r(e).offset().left+360+24);e.style.setProperty("--main-nav_flyout-offset",Math.min(i,0)+"px")}))}calcFlyoutHeight(){this.$el.find(".js-MainNav--overlay").each(((t,e)=>{var i=r(e);if(h(e)&&!i.parents(".js-MainNav--overlay").length){var a=parseInt(r(e).attr("data-mainnav-current-index"))+1;a||(a=1),i.parents(".js-MainNav--more").length&&a--,i.find('.js-MainNav--sub[data-mainnav-index="'+a+'"]').each(((t,i)=>{h(i)&&e.style.setProperty("--main-nav_flyout-height",r(i).outerHeight()+"px")}))}}))}calcMobileFlyoutHeight(){var t=0;this.$el.find('.js-MainNav--sub[data-mainnav-index="'+this.$el.attr("data-mainnav-current-index-mobile")+'"]').each(((e,i)=>{h(i)&&(t=r(i).outerHeight())})),t>0?this.el.style.setProperty("--main-nav_flyout-height-mobile",t+"px"):this.$el.removeAttr("style")}getTransitionDuration(){var t=this.isMobile()?".js-MainNav":".MainNav--overlay, .MainNav--overlay--scroller, .MainNav--overlay--inner",e=document.querySelectorAll(t),i=Array.from(e).map((t=>{return(e=getComputedStyle(t).transitionDuration)?e.endsWith("s")?1e3*Number(e.replace("s","")):e.endsWith("ms")?Number(e.replace("ms","")):0:0;var e}));return Math.max(...i)}}function _(){return new P}export{_ as default};
